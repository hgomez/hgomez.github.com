
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Rico's Blog</title>
  <meta name="author" content="Henri Gomez">

  
  <meta name="description" content="Java on OSX OSX is a good platform for Java development but also running Java applications. Sadly XServe servers are no more available but in many &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://hgomez.github.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Rico's Blog" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">mob</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">Rico's Blog</a></h1>
  
    <h2>Continuous Integration, Delivery, OSX, OpenJDK, Tomcat and much more.</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:hgomez.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/07/20/understanding-java-from-command-line-on-osx/">Understanding Java From Command Line on OSX</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-07-20T20:57:06+02:00" pubdate data-updated="true">Jul 20<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Java on OSX</h1>

<p>OSX is a good platform for Java development but also running Java applications. Sadly XServe servers are no more available but in many cases Mac Mini could to pretty good works as Java server applications.</p>

<p>For a long time, OSX Java was maintained by Apple, from Sun Hotspot and was often a bit late vs Windows/Linux releases.</p>

<p>With Lion, Apple announced that they won&#8217;t produce Java for their futures OS, starting with Mountain Lion (10.8) and Oracle will do the job as they did for major distributions.</p>

<p>OpenJDK project included OSX support more than one year ago and there is now a very good coverage of Java for OSX.</p>

<p>It take some time to see first official Java 7 from Oracle on OSX, for Lion only, but there was community alternatives like <a href="http://code.google.com/p/openjdk-osx-build/">openjdk-osx-build</a>, where you could find a large choice of OpenJDK for OSX (7, 8, 8 with Lambda, 8 with Jigsaw).</p>

<p>If you install Java&#8217;s from <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Oracle</a> or <a href="http://code.google.com/p/openjdk-osx-build/downloads/list">openjdk-osx-build</a>, you may want to know how to select one of them for your application and even select a specific one for some of your applications.</p>

<h1>Java Preferences</h1>

<p>Apple provide a good tool to select default JVM, Java Preferences :</p>

<p><a href="http://blog.hgomez.net/wp-content/uploads/2012/07/JavaPreferences.png"><img src="http://blog.hgomez.net/wp-content/uploads/2012/07/JavaPreferences.png" alt="" /></a></p>

<p>In this screenshot you could see many JVM, from many sources, <strong>Apple, Oracle</strong> and <strong>openjdk-osx-build</strong> and default ordering Java (from up to bottom).</p>

<p>Here you&#8217;ll see that default JVM will be Apple Java 1.6.0_33-b03-424 in 64bits, next choice will be Apple Java 1.6.0_33-b03-424 in 32bits. You will notice these JVM are marked as System, more on this later.</p>

<p>Next you&#8217;ll find Apple Java 1.6.0_31 in 64 and 32 bits and then Java 1.7 (1.7.0-jdk7u6-b20-20120719) from openjdk-osx-build. By the end you&#8217;ll find latest official Oracle Java 7, aka 1.7.0_05.</p>

<p>What does it means for you in a command line mode, console is just mandatory for any serious OSX geek ?</p>

<p>Let see java used by default :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>java -version
</span><span class='line'>java version <span class="s2">&quot;1.6.0_33&quot;</span>
</span><span class='line'>Java<span class="o">(</span>TM<span class="o">)</span> SE Runtime Environment <span class="o">(</span>build 1.6.0_33-b03-424-11M3720<span class="o">)</span>
</span><span class='line'>Java HotSpot<span class="o">(</span>TM<span class="o">)</span> 64-Bit Server VM <span class="o">(</span>build 20.8-b03-424, mixed mode<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Default Java is Apple 1.6.0_33, 64bits as expected, so far so good.</p>

<p>What should i do if I want to select instead Java 7 ?</p>

<h2>Standard Unix way</h2>

<p>You could just update your PATH environment variable to update search path :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/Library/Java/JavaVirtualMachines/1.7.0u6.jdk/Contents/Home/bin:<span class="nv">$PATH</span>
</span><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>java -version
</span><span class='line'>openjdk version <span class="s2">&quot;1.7.0-jdk7u6-b20&quot;</span>
</span><span class='line'>OpenJDK Runtime Environment <span class="o">(</span>build 1.7.0-jdk7u6-b20-20120719<span class="o">)</span>
</span><span class='line'>OpenJDK 64-Bit Server VM <span class="o">(</span>build 23.2-b09, mixed mode<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>It works but OSX provide smarter mechanism.</p>

<h2>OSX way</h2>

<p>Keeping in mind we&#8217;re discussing command line operation, updating default JVM via Java Preferences will not be retained, will define instead <strong>JAVA_HOME</strong> environment variable like this :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span><span class="nb">export </span><span class="nv">JAVA_HOME</span><span class="o">=</span>/Library/Java/JavaVirtualMachines/1.7.0u6.jdk/Contents/Home/
</span><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>java -version
</span><span class='line'>openjdk version <span class="s2">&quot;1.7.0-jdk7u6-b20&quot;</span>
</span><span class='line'>OpenJDK Runtime Environment <span class="o">(</span>build 1.7.0-jdk7u6-b20-20120719<span class="o">)</span>
</span><span class='line'>OpenJDK 64-Bit Server VM <span class="o">(</span>build 23.2-b09, mixed mode<span class="o">)</span>&lt;/pre&gt;
</span></code></pre></td></tr></table></div></figure>


<p>We could keep our current PATH and it will be <strong>Apple java bootstrap</strong> system, living into <strong>/usr/bin/java</strong> who make use of <strong>JAVA_HOME</strong> and launch the proper JVM. Simple but efficient .</p>

<h2>java_home</h2>

<p>As we see previously, Java Preferences define an order of preferred JVM on OSX, like alternatives does on many Linux systems, especially those using <a href="http://www.jpackage.org">JPackage</a> tooling. So there should be a way to get access to these preferences and here entering <strong>java_home</strong></p>

<p>java_home is located in /usr/libexec and has many useful features :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>/usr/libexec/java_home --help
</span><span class='line'>Usage: java_home <span class="o">[</span>options...<span class="o">]</span>
</span><span class='line'>    Returns the path to a Java home directory from the current user<span class="err">&#39;</span>s settings.
</span><span class='line'>
</span><span class='line'>Options:
</span><span class='line'>    <span class="o">[</span>-v/--version   &lt;version&gt;<span class="o">]</span>       Filter Java versions in the <span class="s2">&quot;JVMVersion&quot;</span> form 1.X<span class="o">(</span>+ or *<span class="o">)</span>.
</span><span class='line'>    <span class="o">[</span>-a/--arch      &lt;architecture&gt;<span class="o">]</span>  Filter JVMs matching architecture <span class="o">(</span>i386, x86_64, etc<span class="o">)</span>.
</span><span class='line'>    <span class="o">[</span>-d/--datamodel &lt;datamodel&gt;<span class="o">]</span>     Filter JVMs capable of -d32 or -d64
</span><span class='line'>    <span class="o">[</span>-t/--task      &lt;task&gt;<span class="o">]</span>          Use the JVM list <span class="k">for </span>a specific task <span class="o">(</span>Applets, WebStart, BundledApp, JNI, or CommandLine<span class="o">)</span>
</span><span class='line'>    <span class="o">[</span>-F/--failfast<span class="o">]</span>                  Fail when filters <span class="k">return </span>no JVMs, <span class="k">do </span>not <span class="k">continue </span>with default.
</span><span class='line'>    <span class="o">[</span>   --exec      &lt;<span class="nb">command</span>&gt; ...<span class="o">]</span>   Execute the <span class="nv">$JAVA_HOME</span>/bin/&lt;<span class="nb">command</span>&gt; with the remaining arguments.
</span><span class='line'>    <span class="o">[</span>-R/--request<span class="o">]</span>                   Request installation of a Java Runtime <span class="k">if </span>not installed.
</span><span class='line'>    <span class="o">[</span>-X/--xml<span class="o">]</span>                       Print full JVM list and additional data as XML plist.
</span><span class='line'>    <span class="o">[</span>-V/--verbose<span class="o">]</span>                   Print full JVM list with architectures.
</span><span class='line'>    <span class="o">[</span>-h/--help<span class="o">]</span>                      This usage information.
</span></code></pre></td></tr></table></div></figure>


<p>Let&#8217;s play with <strong>java_home</strong> now.</p>

<p>Obtaining path of default JVM :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>/usr/libexec/java_home
</span><span class='line'>/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home&lt;/pre&gt;
</span></code></pre></td></tr></table></div></figure>


<p>Obtaining path of default Java 7 JVM :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>/usr/libexec/java_home -v 1.7
</span><span class='line'>/Library/Java/JavaVirtualMachines/1.7.0u6.jdk/Contents/Home&lt;/pre&gt;
</span></code></pre></td></tr></table></div></figure>


<p>Obtaining path of default Java 8 JVM :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>/usr/libexec/java_home -v 1.8
</span><span class='line'>/Library/Java/JavaVirtualMachines/1.8.0.jdk/Contents/Home
</span></code></pre></td></tr></table></div></figure>


<p>Obtaining path of default Java 1.6 32 bits JVM :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>/usr/libexec/java_home -v 1.6 -a i386
</span><span class='line'>/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home&lt;/pre&gt;
</span></code></pre></td></tr></table></div></figure>


<p>Obtaining path of default Java 1.6 64 bits JVM :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>/usr/libexec/java_home -v 1.6 -a x86_64
</span><span class='line'>/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home
</span></code></pre></td></tr></table></div></figure>


<p>Here you could see that 32 and 64bits JVM have the same path. This is because due to universal mode (i386/x86_64), <strong>Apple</strong> produce a dual mode JVM. This is not the case for <strong>Oracle Java 7</strong> where only 64bits JVM is available.</p>

<p>Let&#8217;s combine <strong>java_home</strong> and <strong>JAVA_HOME</strong> :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span><span class="nb">export </span><span class="nv">JAVA_HOME</span><span class="o">=</span><span class="sb">`</span>/usr/libexec/java_home -v 1.7<span class="sb">`</span>
</span><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>java -version
</span><span class='line'>openjdk version <span class="s2">&quot;1.7.0-jdk7u6-b20&quot;</span>
</span><span class='line'>OpenJDK Runtime Environment <span class="o">(</span>build 1.7.0-jdk7u6-b20-20120719<span class="o">)</span>
</span><span class='line'>OpenJDK 64-Bit Server VM <span class="o">(</span>build 23.2-b09, mixed mode<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is a very nice features if you want to specify a Java Level (6 or 7) following your<strong> Java Preferences </strong>for some of your server side application (let say <strong>Apache Tomcat</strong>) or command operation (like <strong>Apache Maven</strong>).</p>

<p>Typically for my Apache Tomcat powered application like Jenkins, I usually set it in bin/setenv.sh :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">export </span><span class="nv">JAVA_HOME</span><span class="o">=</span><span class="sb">`</span>/usr/libexec/java_home -v 1.7<span class="sb">`</span>
</span><span class='line'><span class="nv">CATALINA_OPTS</span><span class="o">=</span>-Xms256m -Xmx512m -DJENKINS_HOME<span class="o">=</span><span class="nv">$JENKINS_HOME</span> -Dhudson.model.Hudson.logStartupPerformance<span class="o">=</span><span class="nb">true</span> -Duser.language<span class="o">=</span>en -Djava.awt.headless<span class="o">=</span><span class="nb">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>Do you want to get a list of all JVM on your system ?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mbp-rico:~ henri<span class="nv">$ </span>/usr/libexec/java_home -V
</span><span class='line'>Matching Java Virtual Machines <span class="o">(</span>33<span class="o">)</span>:
</span><span class='line'>    1.6.0_33-b03-424, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home
</span><span class='line'>    1.6.0_33-b03-424, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home
</span><span class='line'>    1.6.0_31-b04-411, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_31-b04-411.jdk/Contents/Home
</span><span class='line'>    1.6.0_31-b04-411, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_31-b04-411.jdk/Contents/Home
</span><span class='line'>    1.7.0-jdk7u6-b20-20120719, x86_64:    <span class="s2">&quot;OpenJDK 7&quot;</span>   /Library/Java/JavaVirtualMachines/1.7.0u6.jdk/Contents/Home
</span><span class='line'>    1.8.0-jdk8-b47-20120720, x86_64:  <span class="s2">&quot;OpenJDK 8&quot;</span>   /Library/Java/JavaVirtualMachines/1.8.0.jdk/Contents/Home
</span><span class='line'>    1.7.0-jdk7u4-b21-20120427, i386:  <span class="s2">&quot;OpenJDK 7&quot;</span>   /Library/Java/JavaVirtualMachines/1.7.0u4.jdk/Contents/Home
</span><span class='line'>    1.7.0_05, x86_64: <span class="s2">&quot;Java SE 7&quot;</span>   /Library/Java/JavaVirtualMachines/1.7.0.jdk/Contents/Home
</span><span class='line'>    1.6.0_33-b03-424, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_33-b03-424.jdk/Contents/Home
</span><span class='line'>    1.6.0_33-b03-424, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_33-b03-424.jdk/Contents/Home
</span><span class='line'>    1.8.0-jdk8-b45-20120713-jigsaw, x86_64:   <span class="s2">&quot;OpenJDK 8&quot;</span>   /Library/Java/JavaVirtualMachines/1.8.0-jigsaw.jdk/Contents/Home
</span><span class='line'>    1.8.0-b48-20120720-lambda, x86_64:    <span class="s2">&quot;OpenJDK 8&quot;</span>   /Library/Java/JavaVirtualMachines/1.8.0-lambda.jdk/Contents/Home
</span><span class='line'>    1.7.0-jdk7u6-b20-20120719, i386:  <span class="s2">&quot;OpenJDK 7&quot;</span>   /Library/Java/JavaVirtualMachines/1.7.0u6.jdk/Contents/Home
</span><span class='line'>    1.7.0-jdk7u4-b21-20120427, x86_64:    <span class="s2">&quot;OpenJDK 7&quot;</span>   /Library/Java/JavaVirtualMachines/1.7.0u4.jdk/Contents/Home
</span><span class='line'>    1.7.0-jdk7u4-b21-20120421, x86_64:    <span class="s2">&quot;OpenJDK 7&quot;</span>   /Library/Java/JavaVirtualMachines/1.7.0u4-64.jdk/Contents/Home
</span><span class='line'>    1.7.0, x86_64:    <span class="s2">&quot;OpenJDK 7&quot;</span>   /Library/Java/JavaVirtualMachines/1.7.0u.jdk/Contents/Home
</span><span class='line'>    1.7.0, i386:  <span class="s2">&quot;OpenJDK 7&quot;</span>   /Library/Java/JavaVirtualMachines/1.7.0u.jdk/Contents/Home
</span><span class='line'>    1.6.0_32-b05-420, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_32-b05-420.jdk/Contents/Home
</span><span class='line'>    1.6.0_32-b05-420, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_32-b05-420.jdk/Contents/Home
</span><span class='line'>    1.6.0_32-b05-417, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_32-b05-417.jdk/Contents/Home
</span><span class='line'>    1.6.0_32-b05-417, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_32-b05-417.jdk/Contents/Home
</span><span class='line'>    1.6.0_31-b04-413, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_31-b04-413.jdk/Contents/Home
</span><span class='line'>    1.6.0_31-b04-413, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_31-b04-413.jdk/Contents/Home
</span><span class='line'>    1.6.0_30-b12-409, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_30-b12-409.jdk/Contents/Home
</span><span class='line'>    1.6.0_30-b12-409, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_30-b12-409.jdk/Contents/Home
</span><span class='line'>    1.6.0_30-b12-404, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_30-b12-404.jdk/Contents/Home
</span><span class='line'>    1.6.0_30-b12-404, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_30-b12-404.jdk/Contents/Home
</span><span class='line'>    1.6.0_29-b11-397, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_29-b11-397.jdk/Contents/Home
</span><span class='line'>    1.6.0_29-b11-397, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_29-b11-397.jdk/Contents/Home
</span><span class='line'>    1.6.0_27-b07-395, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_27-b07-395.jdk/Contents/Home
</span><span class='line'>    1.6.0_27-b07-395, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_27-b07-395.jdk/Contents/Home
</span><span class='line'>    1.6.0_26-b03-383, x86_64: <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_26-b03-383.jdk/Contents/Home
</span><span class='line'>    1.6.0_26-b03-383, i386:   <span class="s2">&quot;Java SE 6&quot;</span>   /Library/Java/JavaVirtualMachines/1.6.0_26-b03-383.jdk/Contents/Home
</span><span class='line'>
</span><span class='line'>/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home
</span></code></pre></td></tr></table></div></figure>


<h2>Note on JVM Locations</h2>

<p>You may have noticed many differents paths for JVM :</p>

<ul>
<li><p>/System/Library/Java/JavaVirtualMachines is where Apple install System JVM. Here you could have only one JVM by family, ie 1.6, 1.7. These JVM will be available to all users on system.</p></li>
<li><p>/Library/Java/JavaVirtualMachines is a slot location for guest JVMs, specially designed to host contributors JVM like <strong>Oracle</strong>, <strong>openjdk-osx-build </strong>or<strong> Apple Developper Preview JVMs</strong> Also, these JVM will be available to all users on system.</p></li>
<li><p>/Users/bill/Library/Java/JavaVirtualMachines is a slot for contributor JVMs but only available to user bill.</p></li>
</ul>


<h2>To conclude</h2>

<p>OSX is probably the platform with the more choice of Java to run and experiment, Java 6, Java 7, OpenJDK 7, 8, Lambda, Jigsaw.</p>

<p>And with its <strong>/usr/libexec/java_home</strong> and <strong>JAVA_HOME</strong> environment variable, you could select any of them for your console or command mode operations very easily.</p>

<p>Enjoy Java on OSX !</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/06/13/building-universal-apache-tomcat-native-library-on-osx-updated/">Building Universal Apache Tomcat Native Library on OS/X - Updated</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-06-13T10:28:13+02:00" pubdate data-updated="true">Jun 13<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Updated build process for tomcat-connector, 1.1.24, no more APXS variable or configure parameters required</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">TCN_RELEASE</span><span class="o">=</span>1.1.24
</span><span class='line'>curl http://mir2.ovh.net/ftp.apache.org/dist//tomcat/tomcat-connectors/native/<span class="nv">$TCN_RELEASE</span>/source/tomcat-native-<span class="nv">$TCN_RELEASE</span>-src.tar.gz -o tomcat-native-<span class="nv">$TCN_RELEASE</span>-src.tar.gz
</span><span class='line'>tar xvzf tomcat-native-<span class="nv">$TCN_RELEASE</span>-src.tar.gz
</span><span class='line'><span class="nb">cd </span>tomcat-native-<span class="nv">$TCN_RELEASE</span>-src/jni/native
</span><span class='line'>
</span><span class='line'><span class="nv">CFLAGS</span><span class="o">=</span><span class="s1">&#39;-arch i386 -arch x86_64&#39;</span> <span class="nv">APXSLDFLAGS</span><span class="o">=</span><span class="s1">&#39;-arch i386 -arch x86_64&#39;</span> ./configure --with-apr<span class="o">=</span>/usr --with-ssl<span class="o">=</span>/usr --with-java-home<span class="o">=</span>/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home
</span><span class='line'>make clean
</span><span class='line'>make
</span><span class='line'>
</span><span class='line'>sudo cp .libs/libtcnative-1.0.1.24.dylib /usr/lib/java
</span><span class='line'>sudo rm -f  /usr/lib/java/libtcnative-1.dylib
</span><span class='line'>sudo ln -s /usr/lib/java/libtcnative-1.0.1.24.dylib /usr/lib/java/libtcnative-1.dylib
</span></code></pre></td></tr></table></div></figure>


<h3>A note about Lion</h3>

<p>If you get Java on Lion using the java command on terminal or via the Java Developer Package for Mac OS X 10.7, Java headers are not on the usual location and you could find them under <strong>/System/Library/Frameworks/JavaVM.framework/Versions/A/Headers</strong></p>

<p>You should then update the <strong>configure</strong> command line like this :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">CFLAGS</span><span class="o">=</span><span class="s1">&#39;-arch i386 -arch x86_64&#39;</span> ./configure --with-apr<span class="o">=</span>/usr --with-ssl<span class="o">=</span>/usr --with-java-home<span class="o">=</span>/System/Library/Frameworks/JavaVM.framework/Versions/A/
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">TCN_RELEASE</span><span class="o">=</span>1.1.24
</span><span class='line'>curl http://mir2.ovh.net/ftp.apache.org/dist//tomcat/tomcat-connectors/native/<span class="nv">$TCN_RELEASE</span>/source/tomcat-native-<span class="nv">$TCN_RELEASE</span>-src.tar.gz -o tomcat-native-<span class="nv">$TCN_RELEASE</span>-src.tar.gz
</span><span class='line'>tar xvzf tomcat-native-<span class="nv">$TCN_RELEASE</span>-src.tar.gz
</span><span class='line'><span class="nb">cd </span>tomcat-native-<span class="nv">$TCN_RELEASE</span>-src/jni/native
</span><span class='line'>
</span><span class='line'><span class="nv">CFLAGS</span><span class="o">=</span><span class="s1">&#39;-arch i386 -arch x86_64&#39;</span> ./configure --with-apr<span class="o">=</span>/usr --with-ssl<span class="o">=</span>/usr --with-java-home<span class="o">=</span>/System/Library/Frameworks/JavaVM.framework/Versions/A/
</span><span class='line'>make clean
</span><span class='line'>make
</span><span class='line'>
</span><span class='line'>sudo cp .libs/libtcnative-1.0.dylib /usr/lib/java
</span><span class='line'>sudo rm -f  /usr/lib/java/libtcnative-1.dylib
</span><span class='line'>sudo ln -s /usr/lib/java/libtcnative-1.0.dylib /usr/lib/java/libtcnative-1.dylib
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/03/21/using-apache-tomcat-connector-mod_jk-on-osx/">Using Apache Tomcat Connector (Mod_jk) on OSX</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-03-21T09:48:34+01:00" pubdate data-updated="true">Mar 21<span>st</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>You&#8217;ll need first mod_jk installed, follow <a href="http://blog.hgomez.net/2012/03/21/building-universal-apache-tomcat-connector-mod_jk-on-osx/">Building Guide</a>.</p>

<p>Create /etc/apache2/other/jk.conf :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Load JK Module</span>
</span><span class='line'>LoadModule jk_module     libexec/apache2/mod_jk.so
</span><span class='line'><span class="c"># JK workers.properties</span>
</span><span class='line'>JkWorkersFile /etc/apache2/other/workers.properties
</span><span class='line'><span class="c"># JK shared memory location</span>
</span><span class='line'>JkShmFile     /var/log/apache2/mod_jk.shm
</span><span class='line'><span class="c"># JK logs</span>
</span><span class='line'>JkLogFile     /var/log/apache2/mod_jk.log
</span><span class='line'><span class="c"># JK log level [debug/error/info]</span>
</span><span class='line'>JkLogLevel    info
</span><span class='line'><span class="c"># JK timestamp log format</span>
</span><span class='line'>JkLogStampFormat <span class="s2">&quot;[%a %b %d %H:%M:%S %Y] &quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create /etc/apache2/other/workers.properties</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>worker.list<span class="o">=</span>jenkins,watch,manage
</span><span class='line'>
</span><span class='line'><span class="c"># Set properties for worker jenkins (ajp13)</span>
</span><span class='line'>worker.jenkins.type<span class="o">=</span>ajp13
</span><span class='line'>worker.jenkins.host<span class="o">=</span>localhost
</span><span class='line'>worker.jenkins.port<span class="o">=</span>8009
</span><span class='line'>
</span><span class='line'><span class="c"># status workers</span>
</span><span class='line'>worker.watch.type<span class="o">=</span>status
</span><span class='line'>worker.watch.read_only<span class="o">=</span><span class="nb">true</span>
</span><span class='line'>worker.watch.mount<span class="o">=</span>/user/status/jk
</span><span class='line'>worker.manage.type<span class="o">=</span>status
</span><span class='line'>worker.manage.mount<span class="o">=</span>/admin/status/jk
</span></code></pre></td></tr></table></div></figure>


<p>I choose to use VirtualName Hosting and so defined one into /etc/apache2/extra/httpd-vhosts.conf :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>NameVirtualHost *:80
</span><span class='line'>
</span><span class='line'>&lt;VirtualHost *:80&gt;
</span><span class='line'>
</span><span class='line'>    ServerName  mbpbuilder.hgomez.net
</span><span class='line'>    ServerAlias mbpbuilder
</span><span class='line'>    ServerAdmin webmaster@mbpbuilder.hgomez.net
</span><span class='line'>
</span><span class='line'>    ErrorLog    <span class="s2">&quot;/var/log/apache2/mbpbuilder.org-error_log&quot;</span>
</span><span class='line'>    CustomLog   <span class="s2">&quot;/var/log/apache2/mbpbuilder-access_log&quot;</span> common
</span><span class='line'>
</span><span class='line'>    JkMount  /* jenkins
</span><span class='line'>
</span><span class='line'>&lt;/VirtualHost&gt;
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/03/21/building-universal-apache-tomcat-connector-mod_jk-on-osx/">Building Universal Apache Tomcat Connector (Mod_jk) on OSX</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-03-21T09:31:18+01:00" pubdate data-updated="true">Mar 21<span>st</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Build Universal Apache Tomcat Connector (mod_jk) for OSX follow tricks used for Apache Tomcat Native Library.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">CFLAGS</span><span class="o">=</span><span class="s1">&#39;-arch i386 -arch x86_64&#39;</span> <span class="nv">APXSLDFLAGS</span><span class="o">=</span><span class="s1">&#39;-arch i386-arch x86_64&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here is a small script to do it :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'><span class="c">#</span>
</span><span class='line'>
</span><span class='line'><span class="nv">JK_VERSION</span><span class="o">=</span>1.2.37
</span><span class='line'>
</span><span class='line'>curl http://mir2.ovh.net/ftp.apache.org/dist/tomcat/tomcat-connectors/jk/tomcat-connectors-<span class="k">${</span><span class="nv">JK_VERSION</span><span class="k">}</span>-src.tar.gz -o tomcat-connectors-<span class="k">${</span><span class="nv">JK_VERSION</span><span class="k">}</span>-src.tar.gz
</span><span class='line'>tar xvzf tomcat-connectors-<span class="k">${</span><span class="nv">JK_VERSION</span><span class="k">}</span>-src.tar.gz
</span><span class='line'><span class="nb">cd </span>tomcat-connectors-<span class="k">${</span><span class="nv">JK_VERSION</span><span class="k">}</span>-src/native
</span><span class='line'>
</span><span class='line'>./configure --with-apxs<span class="o">=</span>/usr/sbin/apxs <span class="nv">CFLAGS</span><span class="o">=</span><span class="s1">&#39;-arch i386 -arch x86_64&#39;</span> <span class="nv">APXSLDFLAGS</span><span class="o">=</span><span class="s1">&#39;-arch i386-arch x86_64&#39;</span>
</span><span class='line'>make clean
</span><span class='line'>make
</span></code></pre></td></tr></table></div></figure>


<p>Installation is pretty simple :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo cp apache-2.0/.libs/mod_jk.so /usr/libexec/apache2/
</span></code></pre></td></tr></table></div></figure>


<p>You could then restart your Apache HTTPd server to get new mod_jk used :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo /usr/sbin/apachectl restart
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/03/18/ssd-or-not-ssd/">SSD or Not SSD ?</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-03-18T10:58:01+01:00" pubdate data-updated="true">Mar 18<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My MacBookPro is quite old now :</p>

<ul>
<li><p>MacBook Pro 5.1 (Late 2008)</p></li>
<li><p>Core2Duo 2.66Ghz</p></li>
</ul>


<p>Under Lion, MBP appears to be sometime laggy even if I already updated it :</p>

<ul>
<li><p>Replaced original 4Gb RAM to 8Gb DDR3 (GSkill PC8500 SQ (1066 MHz), 7-7-7-20)</p></li>
<li><p>Replaced original Hitachi 320GB/5400 RPM by a 500Gb WesternDigital Black Black 7200RPM (WD5000BEKT-75KA9T0)</p></li>
</ul>


<p>I run <a href="http://www.primatelabs.ca/geekbench/">GeekBench 2.2.7</a> and give me a bench result of <strong>3752</strong> :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Benchmark Summary
</span><span class='line'>  Integer Score              3123 <span class="o">||||||||</span>|
</span><span class='line'>  Floating Point Score       5493 <span class="o">||||||||||||||||</span>
</span><span class='line'>  Memory Score               2629 <span class="o">||||||</span>|
</span><span class='line'>  Stream Score               2110 <span class="o">||||||</span>
</span><span class='line'>
</span><span class='line'>  Geekbench Score            3752 <span class="o">||||||||||</span>|
</span><span class='line'>
</span><span class='line'>System Information
</span><span class='line'>  Operating System      Mac OS X 10.7.3 <span class="o">(</span>Build 11D50<span class="o">)</span>
</span><span class='line'>  Model                 MacBook Pro <span class="o">(</span>Late 2008<span class="o">)</span>
</span><span class='line'>  Motherboard           Apple Inc. Mac-F42D86A9 Proto
</span><span class='line'>  Processor             Intel Core 2 Duo T9550 @ 2.66 GHz
</span><span class='line'>                        1 Processor, 2 Cores, 2 Threads
</span><span class='line'>  Processor ID          GenuineIntel Family 6 Model 23 Stepping 10
</span><span class='line'>  L1 Instruction Cache  32.0 KB x 2
</span><span class='line'>  L1 Data Cache         32.0 KB x 2
</span><span class='line'>  L2 Cache              6.00 MB
</span><span class='line'>  L3 Cache              0.00 B
</span><span class='line'>  Memory                8.00 GB 1067 MHz DDR3
</span><span class='line'>  BIOS                  Apple Inc.    MBP51.88Z.007E.B06.1202061253
</span></code></pre></td></tr></table></div></figure>


<p>IOs seems to be the limiting factor, especially when I&#8217;m using VirtualBox, I feel a slow IO performances.</p>

<h2>Time to bench IOs</h2>

<p>There is no tools like <strong><strong>HD Tune </strong></strong>on OSX, so I wrote a very simple shell script to measure raw IO performances.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'><span class="nv">COUNT</span><span class="o">=</span>2048
</span><span class='line'>
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;testing pseudo-IO performances - 1st Pass&quot;</span>
</span><span class='line'>dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>/dev/null <span class="nv">bs</span><span class="o">=</span>1m <span class="nv">count</span><span class="o">=</span><span class="nv">$COUNT</span>
</span><span class='line'>
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;testing IO write performances - 1st Pass&quot;</span>
</span><span class='line'>dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>PERFTEST <span class="nv">bs</span><span class="o">=</span>1m <span class="nv">count</span><span class="o">=</span><span class="nv">$COUNT</span>
</span><span class='line'>
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;testing IO read performances - 1st Pass&quot;</span>
</span><span class='line'>dd <span class="k">if</span><span class="o">=</span>PERFTEST <span class="nv">of</span><span class="o">=</span>/dev/null <span class="nv">bs</span><span class="o">=</span>1m <span class="nv">count</span><span class="o">=</span><span class="nv">$COUNT</span>
</span><span class='line'>
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;testing IO read performances - 2nd Pass&quot;</span>
</span><span class='line'>dd <span class="k">if</span><span class="o">=</span>PERFTEST <span class="nv">of</span><span class="o">=</span>/dev/null <span class="nv">bs</span><span class="o">=</span>1m <span class="nv">count</span><span class="o">=</span><span class="nv">$COUNT</span>
</span><span class='line'>
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;testing IO write performances - 2nd Pass&quot;</span>
</span><span class='line'>dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>PERFTEST <span class="nv">bs</span><span class="o">=</span>1m <span class="nv">count</span><span class="o">=</span><span class="nv">$COUNT</span>
</span></code></pre></td></tr></table></div></figure>


<p>Results :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>testing pseudo-IO performances - 1st Pass
</span><span class='line'>2048+0 records in
</span><span class='line'>2048+0 records out
</span><span class='line'>2147483648 bytes transferred in 0.225590 secs <span class="o">(</span>9519410157 bytes/sec<span class="o">)</span>
</span><span class='line'>testing IO write performances - 1st Pass
</span><span class='line'>2048+0 records in
</span><span class='line'>2048+0 records out
</span><span class='line'>2147483648 bytes transferred in 29.882202 secs <span class="o">(</span>71864973 bytes/sec<span class="o">)</span>
</span><span class='line'>testing IO <span class="nb">read </span>performances - 1st Pass
</span><span class='line'>2048+0 records in
</span><span class='line'>2048+0 records out
</span><span class='line'>2147483648 bytes transferred in 0.677308 secs <span class="o">(</span>3170615711 bytes/sec<span class="o">)</span>
</span><span class='line'>testing IO <span class="nb">read </span>performances - 2nd Pass
</span><span class='line'>2048+0 records in
</span><span class='line'>2048+0 records out
</span><span class='line'>2147483648 bytes transferred in 0.675835 secs <span class="o">(</span>3177527036 bytes/sec<span class="o">)</span>
</span><span class='line'>testing IO write performances - 2nd Pass
</span><span class='line'>2048+0 records in
</span><span class='line'>2048+0 records out
</span><span class='line'>2147483648 bytes transferred in 33.203725 secs <span class="o">(</span>64675986 bytes/sec<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note, I run this performance tests from a directory excluded from Spotlight indexing !</p>

<p><a href="http://blog.hgomez.net/wp-content/uploads/2012/03/SpotLight-Exclude.png"><img src="http://blog.hgomez.net/wp-content/uploads/2012/03/SpotLight-Exclude.png" alt="" /></a></p>

<ul>
<li><p>Pseudo IO performance is justing virtual IO (/dev/zero and /dev/null), so it provide max raw IO performance : <strong>9078 MB/s</strong></p></li>
<li><p>Write IO performance is between <strong>61</strong> and <strong>68 MB/s</strong></p></li>
<li><p>Read IO performance is very high with <strong>3023 MB/s</strong></p></li>
</ul>


<p>I replayed script raising COUNT from <strong>2048</strong> to <strong>20480</strong> to reduce OSX ram buffer impact in Read IO performance but still get about <strong>2000 MB/s</strong></p>

<h3>iStat Menu disk activity - Write Performance</h3>

<p><a href="http://blog.hgomez.net/wp-content/uploads/2012/03/WD-Perfs.png"><img src="http://blog.hgomez.net/wp-content/uploads/2012/03/WD-Perfs.png" alt="" /></a></p>

<h2>Conclusions</h2>

<ul>
<li><p>WD Black Edition perform pretty well on raw sequential Read Operations</p></li>
<li><p>With its average <strong>63 MB/s</strong> raw sequential Write Operations, WD is about 7 time slower than faster SSD like <strong>OCZ Vertex 3</strong></p></li>
</ul>


<p>Is it time to update MBP to SSD ? Probably and my candidates are :</p>

<ul>
<li><p>Crucial M4 128GB. This SSD is reported very stable and reliable. Bonus, its firmware could be updated from Mac.</p></li>
<li><p>OCZ Vertex 3 120GB. This SSD is top performer in benchmarks but Googling it reports many reliability problems.</p></li>
</ul>


<p>I&#8217;d like to get feedback from you, performing same performance testing on your Mac hardware (MBP/ SSD configurations very welcomed).</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/02/20/devops-logo-2nd-try/">DevOps Logo 2nd Try</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-02-20T15:34:55+01:00" pubdate data-updated="true">Feb 20<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here is the second try of logos for DevOps, still provided by Sabrina (@saabpii).
She carefully tracked comments here and on Twitter :</p>

<p><a href="http://blog.hgomez.net/wp-content/uploads/2012/02/logo_devops_v2.jpg"><img src="http://blog.hgomez.net/wp-content/uploads/2012/02/logo_devops_v2.jpg" alt="" /></a></p>

<p>Please vote for your preferred one.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/02/08/devops-logos/">DevOps Logos</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-02-08T09:08:27+01:00" pubdate data-updated="true">Feb 8<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I asked some times ago Sabrina Perrin (@saabpii) a great graphic designer I worked with for years, if she could try to works on some DevOps logo.</p>

<p>As expected she has been very motivated and inspired.</p>

<p>Here are the results :</p>

<p>[caption id=&#8221;attachment_964&#8221; align=&#8221;alignnone&#8221; width=&#8221;1181&#8221; caption=&#8221;some DevOps Logo&#8221;]<a href="http://blog.hgomez.net/wp-content/uploads/2012/02/logo_devops2.jpg"><img src="http://blog.hgomez.net/wp-content/uploads/2012/02/logo_devops2.jpg" alt="" /></a>[/caption]</p>

<p>Now I need you to comments and votes for them.</p>

<p>All of this artwork is free to use, just mention Sabrina somewhere on your sites/blogs/presentations.</p>

<p>Thanks again Sabrina !</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/01/28/uninstalling-macfuse-on-lion/">Uninstalling MacFuse on Lion</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-01-28T10:13:42+01:00" pubdate data-updated="true">Jan 28<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you installed MacFuse on Lion (10.7) and tried to uninstall you may encountered the following error :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo /Library/Filesystems/fusefs.fs/Support/uninstall-macfuse-core.sh
</span><span class='line'>MacFUSE Uninstaller: Can not find the Archive.bom <span class="k">for </span>MacFUSE Core package.
</span></code></pre></td></tr></table></div></figure>


<p>Uninstaller didn&#8217;t check for Lion (uname -r reporting 11.x).
So fix is easy, just edit uninstaller script <strong>/Library/Filesystems/fusefs.fs/Support/uninstall-macfuse-core.sh</strong> and add 11<em>) in case next to 10</em>)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>...
</span><span class='line'>
</span><span class='line'><span class="nv">OS_RELEASE</span><span class="o">=</span><span class="sb">`</span>/usr/bin/uname -r<span class="sb">`</span>
</span><span class='line'><span class="k">case</span> <span class="s2">&quot;$OS_RELEASE&quot;</span> in
</span><span class='line'>  8*<span class="o">)</span>
</span><span class='line'>    log <span class="s2">&quot;Incorrect uninstall. Use the Tiger version please.&quot;</span>
</span><span class='line'>    <span class="nb">exit </span>1
</span><span class='line'>    ;;
</span><span class='line'>  9*<span class="o">)</span>
</span><span class='line'>    <span class="nv">PACKAGE_RECEIPT</span><span class="o">=</span><span class="s2">&quot;$INSTALL_VOLUME/Library/Receipts/MacFUSE Core.pkg&quot;</span>
</span><span class='line'>    <span class="nv">OUTER_PACKAGE_RECEIPT</span><span class="o">=</span><span class="s2">&quot;$INSTALL_VOLUME/Library/Receipts/MacFUSE.pkg&quot;</span>
</span><span class='line'>    <span class="nv">BOMFILE</span><span class="o">=</span><span class="s2">&quot;$PACKAGE_RECEIPT/Contents/Archive.bom&quot;</span>
</span><span class='line'>    ;;
</span><span class='line'>  10*|11*<span class="o">)</span>
</span><span class='line'>     <span class="nv">PACKAGE_RECEIPT</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</span><span class='line'>     <span class="nv">BOMFILE</span><span class="o">=</span><span class="s2">&quot;$INSTALL_VOLUME/var/db/receipts/com.google.macfuse.core.bom&quot;</span>
</span><span class='line'>     ;;
</span><span class='line'><span class="k">esac</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2011/12/28/batch-rpm-signing/">Batch Rpm Signing</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2011-12-28T18:05:42+01:00" pubdate data-updated="true">Dec 28<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;m using <a href="http://jenkins-ci.org/">Jenkins</a> to build RPMs with free-style scripts.</p>

<p>Decent RPM packager should sign his RPMs so they could be checked by yum/zypper tools.</p>

<p>Here you could be in trouble since rpm signing require a password to be passed in command line :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rpm --addsign -D <span class="s2">&quot;_signature gpg&quot;</span> -D <span class="s2">&quot;_gpg_name packagers@myforge.org&quot;</span> RPMS/noarch/myjenkins-1.0.0-1.noarch.rpm&lt;br /&gt;
</span><span class='line'>Enter pass phrase:&lt;br /&gt;
</span></code></pre></td></tr></table></div></figure>


<p>It&#8217;s quite problematic for a RPM build factory.</p>

<p>After digging around Internet, best solution appears to be using <a href="http://expect.sourceforge.net/">expect</a> and I developped a simple script for such purpose with following constraints :</p>

<ul>
<li><p>packager gpg name should be parametized (to avoid injecting it in ~/.rpmmacros)</p></li>
<li><p>gpg passphrase should be provided to command line (could be read from a secret file)</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/usr/bin/expect -f</span>
</span><span class='line'><span class="c">#</span>
</span><span class='line'><span class="c"># rpmsign-batch.expect : expect powered rpm signing command</span>
</span><span class='line'><span class="c">#</span>
</span><span class='line'>
</span><span class='line'>proc usage <span class="o">{}</span> <span class="o">{</span>
</span><span class='line'>        send_user <span class="s2">&quot;Usage: rpmsign-batch.expect gpgname passphrase rpmfile\n\n&quot;</span>
</span><span class='line'>        <span class="nb">exit</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="o">{[</span>llength <span class="nv">$argv</span><span class="o">]</span>!<span class="o">=</span>3<span class="o">}</span> usage
</span><span class='line'>
</span><span class='line'><span class="nb">set </span>gpgname <span class="o">[</span>lrange <span class="nv">$argv</span> 0 0<span class="o">]</span>
</span><span class='line'><span class="nb">set </span>passphrase <span class="o">[</span>lrange <span class="nv">$argv</span> 1 1<span class="o">]</span>
</span><span class='line'><span class="nb">set </span>rpmfile <span class="o">[</span>lrange <span class="nv">$argv</span> 2 2<span class="o">]</span>
</span><span class='line'>
</span><span class='line'>send_user <span class="s2">&quot;passphrase=$passphrase gpgname=$gpgname\n&quot;</span>
</span><span class='line'>
</span><span class='line'>spawn rpm --addsign -D <span class="s2">&quot;_signature gpg&quot;</span> -D <span class="s2">&quot;_gpg_name $gpgname&quot;</span> <span class="nv">$rpmfile</span>
</span><span class='line'>expect -exact <span class="s2">&quot;Enter pass phrase: &quot;</span>
</span><span class='line'>send -- <span class="s2">&quot;$passphrase\r&quot;</span>
</span><span class='line'>expect eof
</span></code></pre></td></tr></table></div></figure>


<p>You could then use it to sign rpms from your freestyle jobs like :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Password provided in clear in job (weird)</span>
</span><span class='line'>rpmsign-batch.expect packagers@myforge.org mypassphrase RPMS/noarch/myjenkins-1.0.0-1.noarch.rpm
</span><span class='line'>
</span><span class='line'><span class="c"># Password grabbed from a secret file (better)</span>
</span><span class='line'><span class="nv">PASSPHRASE</span><span class="o">=</span><span class="sb">`</span>cat /my/secret-passphrase-file<span class="sb">`</span>
</span><span class='line'>rpmsign-batch.expect packagers@myforge.org <span class="nv">$PASSPHRASE</span> RPMS/noarch/myjenkins-1.0.0-1.noarch.rpm
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2011/11/03/iozone-and-gnuplot-4-x/">Iozone and Gnuplot 4.x</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2011-11-03T20:16:40+01:00" pubdate data-updated="true">Nov 3<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.iozone.org/">Iozone </a> is a great tool to mesure performance of filesystem.
You could find 10 examples <a href="http://www.thegeekstuff.com/2011/05/iozone-examples/">here</a>.</p>

<p>In it latest version, 3.97, it came with reporting tools, <strong>report.pl</strong> and <strong>gengnuplot.sh</strong>, who use gnuplot to render images.</p>

<p><a href="http://blog.hgomez.net/wp-content/uploads/2011/11/2d-recrewrite.png"><img src="http://blog.hgomez.net/wp-content/uploads/2011/11/2d-recrewrite.png" alt="" /></a></p>

<p><a href="http://blog.hgomez.net/wp-content/uploads/2011/11/recrewrite.png"><img src="http://blog.hgomez.net/wp-content/uploads/2011/11/recrewrite.png" alt="" /></a></p>

<p>Due to changes in GnuPlot 4.x, <strong>report.pl</strong> and <strong>gnu3d.dem</strong> need to be updated to works.
Also you may get only <strong>8 metrics</strong> in reports instead of <strong>15</strong> expected in latest release of <strong>report.pl</strong></p>

<h2>gnu3d.dem</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># $Id: 3D plot of performance</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># Processes files that were created by Generate_Graphs</span>
</span><span class='line'><span class="c1"># and displays the results. Also, saves a postscript copy.</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># Don Capps</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">parametric</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;write/iozone_gen_out.gnuplot&#39;</span> <span class="n">title</span> <span class="s">&quot;Write performance&quot;</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;write/write.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;write/iozone_gen_out.gnuplot&#39;</span> <span class="n">title</span> <span class="s">&quot;Write performance&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;rewrite/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;ReWrite performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;rewrite/rewrite.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;rewrite/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;ReWrite performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;read/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Read performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;read/read.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;read/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Read performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;reread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Reread performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;reread/reread.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;reread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Reread performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;randread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Random read performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;randread/randread.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;randread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Random read performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;randwrite/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Random write performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;randwrite/randwrite.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;randwrite/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Random write performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;bkwdread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Read Backwards performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;bkwdread/bkwdread.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;bkwdread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Read Backwards performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;recrewrite/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Record rewrite performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;recrewrite/recrewrite.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;recrewrite/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Record rewrite performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;strideread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Stride read performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;strideread/strideread.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;strideread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Stride read performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;fwrite/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Fwrite performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;fwrite/fwrite.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;fwrite/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Fwrite performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;frewrite/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Frewrite performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;frewrite/frewrite.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;frewrite/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Frewrite performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;fread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Fread performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to continue&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;fread/fread.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;fread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Fread performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">x11</span>
</span><span class='line'><span class="n">set</span> <span class="n">title</span> <span class="s">&quot;Iozone performance&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">grid</span> <span class="ow">lt</span> <span class="mi">2</span> <span class="n">lw</span> <span class="mi">1</span>
</span><span class='line'><span class="n">set</span> <span class="n">surface</span>
</span><span class='line'><span class="n">set</span> <span class="n">xtics</span>
</span><span class='line'><span class="n">set</span> <span class="n">ytics</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">x</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">logscale</span> <span class="n">y</span> <span class="mi">2</span>
</span><span class='line'><span class="n">set</span> <span class="n">autoscale</span> <span class="n">z</span>
</span><span class='line'><span class="c1">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="n">set</span> <span class="n">xlabel</span> <span class="s">&quot;File size in 2^n KBytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">ylabel</span> <span class="s">&quot;Record size in 2^n Kbytes&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">zlabel</span> <span class="s">&quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="c1">#set data style lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">style</span> <span class="n">data</span> <span class="n">lines</span>
</span><span class='line'><span class="n">set</span> <span class="n">dgrid3d</span> <span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;freread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Freread performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span><span class='line'><span class="n">pause</span> <span class="o">-</span><span class="mi">1</span> <span class="s">&quot;Hit return to exit&quot;</span>
</span><span class='line'><span class="n">set</span> <span class="n">terminal</span> <span class="n">postscript</span> <span class="n">color</span>
</span><span class='line'><span class="n">set</span> <span class="n">output</span> <span class="s">&quot;freread/freread.ps&quot;</span>
</span><span class='line'><span class="n">splot</span> <span class="s">&#39;freread/iozone_gen_out.gnuplot&#39;</span> <span class="n">using</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span> <span class="n">title</span> <span class="s">&quot;Freread performance&quot;</span> <span class="n">with</span> <span class="n">lines</span>
</span></code></pre></td></tr></table></div></figure>


<h2>report.pl</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="c1">#!/usr/bin/perl</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># arguments: one of more report files</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># Christian Mautner &lt;christian * mautner . ca&gt;, 2005-10-31</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># This script is based loosely on the Generate_Graph set</span>
</span><span class='line'><span class="c1"># of scripts that come with iozone, but is a complete re-write</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># The main reason to write this was the need to compare the behaviour of</span>
</span><span class='line'><span class="c1"># two or more different setups, for tuning filesystems or </span>
</span><span class='line'><span class="c1"># comparing different pieces of hardware.</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># This script is in the public domain, too short and too trivial</span>
</span><span class='line'><span class="c1"># to deserve a copyright.</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># Simply run iozone like, for example, ./iozone -a -g 4G &gt; config1.out (if your machine has 4GB)</span>
</span><span class='line'><span class="c1"># and then run perl report.pl config1.out</span>
</span><span class='line'><span class="c1"># or get another report from another box into config2.out and run</span>
</span><span class='line'><span class="c1"># perl report.pl config1.out config2.out</span>
</span><span class='line'><span class="c1"># the look in the report_* directory for .png</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># If you don&#39;t like png or the graphic size, search for &quot;set terminal&quot; in this file and put whatever gnuplot</span>
</span><span class='line'><span class="c1"># terminal you want. Note I&#39;ve also noticed that gnuplot switched the set terminal png syntax</span>
</span><span class='line'><span class="c1"># a while back, you might need &quot;set terminal png small size 900,700&quot;</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nv">@Reports</span><span class="o">=</span><span class="nv">@ARGV</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">die</span> <span class="s">&quot;usage: $0 &lt;iozone.out&gt; [&lt;iozone2.out&gt;...]\n&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="nv">@Reports</span> <span class="ow">or</span> <span class="nb">grep</span> <span class="p">(</span><span class="n">m</span><span class="o">|^-|</span><span class="p">,</span> <span class="nv">@Reports</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">die</span> <span class="s">&quot;report files must be in current directory&quot;</span> <span class="k">if</span> <span class="nb">grep</span> <span class="p">(</span><span class="n">m</span><span class="o">|/|</span><span class="p">,</span> <span class="nv">@Reports</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nv">%columns</span><span class="o">=</span><span class="p">(</span>
</span><span class='line'>         <span class="s">&#39;write&#39;</span>     <span class="o">=&gt;</span><span class="mi">3</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;read&#39;</span>      <span class="o">=&gt;</span><span class="mi">5</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;rewrite&#39;</span>   <span class="o">=&gt;</span><span class="mi">4</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;reread&#39;</span>    <span class="o">=&gt;</span><span class="mi">6</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;randread&#39;</span>  <span class="o">=&gt;</span><span class="mi">7</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;randwrite&#39;</span> <span class="o">=&gt;</span><span class="mi">8</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;bkwdread&#39;</span>  <span class="o">=&gt;</span><span class="mi">9</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;recrewrite&#39;</span><span class="o">=&gt;</span><span class="mi">10</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;strideread&#39;</span><span class="o">=&gt;</span><span class="mi">11</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;fwrite&#39;</span>    <span class="o">=&gt;</span><span class="mi">12</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;frewrite&#39;</span>  <span class="o">=&gt;</span><span class="mi">13</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;fread&#39;</span>     <span class="o">=&gt;</span><span class="mi">14</span><span class="p">,</span>
</span><span class='line'>         <span class="s">&#39;freread&#39;</span>   <span class="o">=&gt;</span><span class="mi">15</span><span class="p">,</span>
</span><span class='line'>         <span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># create output directory. the name is the concatenation</span>
</span><span class='line'><span class="c1"># of all report file names (minus the file extension, plus</span>
</span><span class='line'><span class="c1"># prefix report_)</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="nv">$outdir</span><span class="o">=</span><span class="s">&quot;report_&quot;</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span><span class="nb">map</span><span class="p">{</span><span class="sr">/([^\.]+)(\..*)?/</span> <span class="o">&amp;&amp;</span> <span class="nv">$1</span><span class="p">}(</span><span class="nv">@Reports</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;Output directory: $outdir &quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="o">-</span><span class="n">d</span> <span class="nv">$outdir</span> <span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;(removing old directory) &quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">system</span> <span class="s">&quot;rm -rf $outdir&quot;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nb">mkdir</span> <span class="nv">$outdir</span> <span class="ow">or</span> <span class="nb">die</span> <span class="s">&quot;cannot make directory $outdir&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;done.\nPreparing data files...&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">foreach</span> <span class="nv">$report</span> <span class="p">(</span><span class="nv">@Reports</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="nb">open</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="nv">$report</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">die</span> <span class="s">&quot;cannot open $report for reading&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$report</span><span class="o">=~</span><span class="sr">/^([^\.]+)/</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$datafile</span><span class="o">=</span><span class="s">&quot;$1.dat&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">push</span> <span class="nv">@datafiles</span><span class="p">,</span> <span class="nv">$datafile</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">open</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="s">&quot;&gt;$outdir/$datafile&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">die</span> <span class="s">&quot;cannot open $outdir/$datafile for writing&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">open</span><span class="p">(</span><span class="n">O2</span><span class="p">,</span> <span class="s">&quot;&gt;$outdir/2d-$datafile&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">die</span> <span class="s">&quot;cannot open $outdir/$datafile for writing&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">while</span><span class="p">(</span><span class="sr">&lt;I&gt;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">next</span> <span class="k">unless</span> <span class="p">(</span><span class="sr"> /^[\s\d]+$/</span> <span class="p">);</span>
</span><span class='line'>        <span class="nv">@split</span> <span class="o">=</span> <span class="nb">split</span><span class="p">();</span>
</span><span class='line'>        <span class="c1"># We may have only 7 metrics (no block entries). Replaced == 15 with &gt;=8</span>
</span><span class='line'>        <span class="k">next</span> <span class="k">unless</span> <span class="p">(</span> <span class="nv">@split</span> <span class="o">&gt;=</span> <span class="mi">8</span> <span class="p">);</span>
</span><span class='line'>        <span class="k">print</span> <span class="n">O</span><span class="p">;</span>
</span><span class='line'>        <span class="k">print</span> <span class="n">O2</span> <span class="k">if</span> <span class="nv">$split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">16384</span> <span class="ow">or</span> <span class="nv">$split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$split</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="nb">close</span> <span class="n">I</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">O2</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;done.\nGenerating graphs:&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">foreach</span> <span class="nv">$column</span> <span class="p">(</span><span class="nb">keys</span> <span class="nv">%columns</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot; $column&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">open</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="s">&quot;&gt;$outdir/$column.do&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">die</span> <span class="s">&quot;cannot open $outdir/$column.do for writing&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">G</span> <span class="sx">qq{</span>
</span><span class='line'><span class="sx">set title &quot;Iozone performance: $column&quot;</span>
</span><span class='line'><span class="sx">set grid lt 2 lw 1</span>
</span><span class='line'><span class="sx">set surface</span>
</span><span class='line'><span class="sx">set parametric</span>
</span><span class='line'><span class="sx">set xtics</span>
</span><span class='line'><span class="sx">set ytics</span>
</span><span class='line'><span class="sx">set logscale x 2</span>
</span><span class='line'><span class="sx">set logscale y 2</span>
</span><span class='line'><span class="sx">set autoscale z</span>
</span><span class='line'><span class="sx">#set xrange [2.**5:2.**24]</span>
</span><span class='line'><span class="sx">set xlabel &quot;File size in KBytes&quot;</span>
</span><span class='line'><span class="sx">set ylabel &quot;Record size in Kbytes&quot;</span>
</span><span class='line'><span class="sx">set zlabel &quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="sx">#set data style lines</span>
</span><span class='line'><span class="sx">set style data lines</span>
</span><span class='line'><span class="sx">set dgrid3d 80,80,3</span>
</span><span class='line'><span class="sx">#set terminal png small picsize 900 700</span>
</span><span class='line'><span class="sx">set terminal png small size 900 700</span>
</span><span class='line'><span class="sx">set output &quot;$column.png&quot;</span>
</span><span class='line'><span class="sx">}</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">print</span> <span class="n">G</span> <span class="s">&quot;splot &quot;</span><span class="o">.</span> <span class="nb">join</span><span class="p">(</span><span class="s">&quot;, &quot;</span><span class="p">,</span> <span class="nb">map</span><span class="p">{</span><span class="sx">qq{&quot;$_&quot; using 1:2:$columns{$column} title &quot;$_&quot;}</span><span class="p">}(</span><span class="nv">@datafiles</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">print</span> <span class="n">G</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">close</span> <span class="n">G</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">open</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="s">&quot;&gt;$outdir/2d-$column.do&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">die</span> <span class="s">&quot;cannot open $outdir/$column.do for writing&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">G</span> <span class="sx">qq{</span>
</span><span class='line'><span class="sx">set title &quot;Iozone performance: $column&quot;</span>
</span><span class='line'><span class="sx">#set terminal png small picsize 450 350</span>
</span><span class='line'><span class="sx">set terminal png small size 450 350</span>
</span><span class='line'><span class="sx">set logscale x</span>
</span><span class='line'><span class="sx">set xlabel &quot;File size in KBytes&quot;</span>
</span><span class='line'><span class="sx">set ylabel &quot;Kbytes/sec&quot;</span>
</span><span class='line'><span class="sx">set output &quot;2d-$column.png&quot;</span>
</span><span class='line'><span class="sx">}</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">print</span> <span class="n">G</span> <span class="s">&quot;plot &quot;</span><span class="o">.</span> <span class="nb">join</span><span class="p">(</span><span class="s">&quot;, &quot;</span><span class="p">,</span> <span class="nb">map</span><span class="p">{</span><span class="sx">qq{&quot;2d-$_&quot; using 1:$columns{$column} title &quot;$_&quot; with lines}</span><span class="p">}(</span><span class="nv">@datafiles</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">print</span> <span class="n">G</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">close</span> <span class="n">G</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span> <span class="nb">system</span><span class="p">(</span><span class="s">&quot;cd $outdir &amp;&amp; gnuplot $column.do &amp;&amp; gnuplot 2d-$column.do&quot;</span><span class="p">)</span> <span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;(failed) &quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;(ok) &quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;done.\n&quot;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/07/20/understanding-java-from-command-line-on-osx/">Understanding java from command line on OSX</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/13/building-universal-apache-tomcat-native-library-on-osx-updated/">Building Universal Apache Tomcat Native Library on OS/X - updated</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/21/using-apache-tomcat-connector-mod_jk-on-osx/">Using Apache Tomcat Connector (mod_jk) on OSX</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/21/building-universal-apache-tomcat-connector-mod_jk-on-osx/">Building Universal Apache Tomcat Connector (mod_jk) on OSX</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/18/ssd-or-not-ssd/">SSD or not SSD ?</a>
      </li>
    
  </ul>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Henri Gomez -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
